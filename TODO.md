TODO:
- use fs2 library for stream processing
- use cats-effect for side effects